<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>西安城乡融合要素交易市场数据可视化展示平台</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .status-bar {
            background: #f8f9fa;
            padding: 15px 30px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .connection-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .status-connected {
            background: #28a745;
        }

        .status-disconnected {
            background: #dc3545;
        }

        .status-connecting {
            background: #ffc107;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .data-info {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #6c757d;
        }

        .info-item i {
            color: #667eea;
        }

        .table-container {
            padding: 30px;
            overflow-x: auto;
        }

        .table-wrapper {
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            overflow: hidden;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 18px 15px;
            text-align: left;
            font-weight: 600;
            font-size: 15px;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        th:first-child {
            border-top-left-radius: 15px;
        }

        th:last-child {
            border-top-right-radius: 15px;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #f1f3f4;
            transition: background-color 0.2s ease;
        }

        tr:hover td {
            background-color: #f8f9ff;
        }

        tr:last-child td {
            border-bottom: none;
        }

        .amount-cell {
            font-weight: 600;
            color: #28a745;
            text-align: right;
        }

        .count-cell {
            font-weight: 600;
            color: #007bff;
            text-align: center;
        }

        .category-cell {
            font-weight: 500;
            color: #495057;
        }

        .region-cell {
            font-weight: 500;
            color: #6c757d;
        }

        .loading {
            text-align: center;
            padding: 60px 20px;
            color: #6c757d;
        }

        .loading i {
            font-size: 3em;
            color: #667eea;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .no-data {
            text-align: center;
            padding: 60px 20px;
            color: #6c757d;
        }

        .no-data i {
            font-size: 4em;
            color: #dee2e6;
            margin-bottom: 20px;
        }

        .refresh-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: transform 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .refresh-btn:hover {
            transform: translateY(-2px);
        }

        .refresh-btn:active {
            transform: translateY(0);
        }

        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            text-align: center;
            transition: transform 0.2s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card i {
            font-size: 2.5em;
            margin-bottom: 15px;
        }

        .stat-card .stat-value {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-card .stat-label {
            color: #6c757d;
            font-size: 0.9em;
        }

        .card-total {
            color: #28a745;
        }

        .card-categories {
            color: #007bff;
        }

        .card-amount {
            color: #fd7e14;
        }

        .card-count {
            color: #6f42c1;
        }

        /* ECharts地图卡片样式 */
        .echarts-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            margin: 30px 30px 0 30px;
            padding: 0;
            overflow: hidden;
            min-height: 480px;
        }
        #echarts-map {
            width: 100%;
            height: 480px;
            min-height: 320px;
        }
        @media (max-width: 768px) {
            .echarts-card {
                margin: 15px 0 0 0;
            }
            #echarts-map {
                height: 320px;
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            
            .status-bar {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .stats-cards {
                grid-template-columns: 1fr;
            }
            
            .table-container {
                padding: 15px;
            }
            
            th, td {
                padding: 12px 8px;
                font-size: 13px;
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-chart-line"></i> 西安城乡融合要素交易市场</h1>
            <p>数据可视化展示平台，实时监控成交数据统计</p>
        </div>

        <div class="status-bar">
            <div class="info-item">
                <label for="region-filter"><i class="fas fa-filter"></i> 行政区筛选：</label>
                <select id="region-filter" onchange="onRegionFilterChange()">
                    <option value="ALL">全部</option>
                </select>
            </div>
            <div class="connection-status">
                <div class="status-indicator status-connecting" id="status-indicator"></div>
                <span id="connection-text">正在连接...</span>
            </div>
            <div class="data-info">
                <div class="info-item">
                    <i class="fas fa-clock"></i>
                    <span id="last-update">--</span>
                </div>
                <div class="info-item">
                    <i class="fas fa-database"></i>
                    <span id="record-count">0 条记录</span>
                </div>
            </div>
            <button class="refresh-btn" onclick="refreshConnection()">
                <i class="fas fa-sync-alt"></i>
                重连数据库
            </button>
        </div>

        <!-- ECharts地图卡片 -->
        <div class="echarts-card">
            <div id="echarts-map"></div>
        </div>

        <div class="table-container">
            <div class="stats-cards" id="stats-cards" style="display: none;">
                <div class="stat-card">
                    <i class="fas fa-list card-total"></i>
                    <div class="stat-value" id="total-records">0</div>
                    <div class="stat-label">总记录数</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-tags card-categories"></i>
                    <div class="stat-value" id="total-categories">0</div>
                    <div class="stat-label">项目类别</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-yen-sign card-amount"></i>
                    <div class="stat-value" id="total-amount">0</div>
                    <div class="stat-label">总成交金额(万元)</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-handshake card-count"></i>
                    <div class="stat-value" id="total-count">0</div>
                    <div class="stat-label">总成交笔数</div>
                </div>
            </div>

            <div class="table-wrapper">
                <table id="data-table">
                    <thead>
                        <tr>
                            <th><i class="fas fa-map-marker-alt"></i> 行政区划</th>
                            <th><i class="fas fa-tag"></i> 项目类别</th>
                            <th><i class="fas fa-yen-sign"></i> 成交金额(万元)</th>
                            <th><i class="fas fa-handshake"></i> 成交笔数</th>
                        </tr>
                    </thead>
                    <tbody id="table-body">
                        <tr>
                            <td colspan="4" class="loading">
                                <i class="fas fa-spinner"></i>
                                <div>正在加载数据...</div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        let socket = null;
        let reconnectAttempts = 0;
        const maxReconnectAttempts = 5;
        let allData = [];
        let currentRegion = 'ALL';
        let latestData = [];
        let refreshTimer = null;
        const REFRESH_INTERVAL = 10000; 
        let firstRenderDone = false;

        //行政区划码与区县名称映射
        const regionMap = {
            '610102': '新城区',
            '610103': '碑林区',
            '610104': '莲湖区',
            '610111': '灞桥区',
            '610112': '未央区',
            '610113': '雁塔区',
            '610114': '阎良区',
            '610115': '临潼区',
            '610116': '长安区',
            '610117': '高陵区',
            '610118': '鄠邑区',
            '610122': '蓝田县',
            '610124': '周至县',
            '610193': '西咸新区',
            '610191': '高新区',
            '610192': '国际港务区'
        };

        document.addEventListener('DOMContentLoaded', function() {
            connectWebSocket();
        });

        function connectWebSocket() {
            updateConnectionStatus('connecting', '正在连接数据库...');
            
            socket = new WebSocket('ws://localhost:3000');

            socket.onopen = () => {
                console.log('Connected to WebSocket server');
                updateConnectionStatus('connected', '数据库已连接');
                reconnectAttempts = 0;
            };

            socket.onmessage = (event) => {
                try {
                    const data = JSON.parse(event.data);
                    latestData = data;
                    if (!firstRenderDone) {
                        renderData(latestData);
                        updateLastUpdate();
                        firstRenderDone = true;
                        
                        refreshTimer = setInterval(() => {
                            if (latestData && latestData.length > 0) {
                                renderData(latestData);
                                updateLastUpdate();
                            }
                        }, REFRESH_INTERVAL);
                    }
                } catch (error) {
                    console.error('Error parsing data:', error);
                }
            };

            socket.onerror = (error) => {
                console.error('WebSocket error:', error);
                updateConnectionStatus('disconnected', '数据库连接错误');
            };

            socket.onclose = () => {
                console.log('Disconnected from WebSocket server');
                updateConnectionStatus('disconnected', '数据库连接断开');
                
                if (reconnectAttempts < maxReconnectAttempts) {
                    reconnectAttempts++;
                    setTimeout(() => {
                        console.log(`Attempting to reconnect... (${reconnectAttempts}/${maxReconnectAttempts})`);
                        connectWebSocket();
                    }, 3000);
                }
            };
        }

        function updateConnectionStatus(status, text) {
            const indicator = document.getElementById('status-indicator');
            const textElement = document.getElementById('connection-text');
            
            indicator.className = `status-indicator status-${status}`;
            textElement.textContent = text;
        }

        function updateLastUpdate() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('zh-CN');
            document.getElementById('last-update').textContent = `最后更新: ${timeString}`;
        }

        function renderData(data) {
            allData = data;
            updateRegionFilterOptions(data);
            filterAndRender();
        }

        function updateRegionFilterOptions(data) {
            const select = document.getElementById('region-filter');
            const regions = Array.from(new Set(data.map(row => (row['行政区划码'] || '').substring(0, 6)))).filter(r => r);
            regions.sort();
            select.innerHTML = '<option value="ALL">全部</option>' +
                regions.map(region => {
                    const name = regionMap[region] || region;
                    return `<option value="${region}">${name}</option>`;
                }).join('');
            select.value = currentRegion;
        }

        function onRegionFilterChange() {
            const select = document.getElementById('region-filter');
            currentRegion = select.value;
            filterAndRender();
        }

        function filterAndRender() {
            let filtered = allData;
            if (currentRegion !== 'ALL') {
                filtered = allData.filter(row => (row['行政区划码'] || '').substring(0, 6) === currentRegion);
            }
            if (!filtered || filtered.length === 0) {
                showNoData();
                return;
            }
            document.getElementById('stats-cards').style.display = 'grid';
            updateStats(filtered);
            renderTable(filtered);
            mergeCells(document.getElementById('data-table'), 0);
        }

        function updateStats(data) {
            const totalRecords = data.length;
            const totalCategories = new Set(data.map(row => row['项目类别'])).size;
            const totalAmount = data.reduce((sum, row) => sum + (parseFloat(row['成交金额']) || 0), 0);
            const totalCount = data.reduce((sum, row) => sum + (parseInt(row['成交笔数']) || 0), 0);

            document.getElementById('total-records').textContent = totalRecords;
            document.getElementById('total-categories').textContent = totalCategories;
            document.getElementById('total-amount').textContent = totalAmount.toFixed(2);
            document.getElementById('total-count').textContent = totalCount;
            document.getElementById('record-count').textContent = `${totalRecords} 条记录`;
        }

        function renderTable(data) {
            const tbody = document.getElementById('table-body');
            tbody.innerHTML = '';

            data.forEach((row, index) => {
                const tr = document.createElement('tr');
                tr.className = 'fade-in';
                tr.style.animationDelay = `${index * 0.05}s`;

                //行政区划
                const td1 = document.createElement('td');
                td1.className = 'region-cell';
                const regionCode = (row['行政区划码'] || '').substring(0, 6);
                td1.textContent = regionMap[regionCode] || regionCode || '--';
                tr.appendChild(td1);

                //项目类别
                const td2 = document.createElement('td');
                td2.className = 'category-cell';
                td2.textContent = row['项目类别'] || '--';
                tr.appendChild(td2);

                //成交金额
                const td3 = document.createElement('td');
                td3.className = 'amount-cell';
                const amount = parseFloat(row['成交金额']) || 0;
                td3.textContent = amount.toLocaleString('zh-CN', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                tr.appendChild(td3);

                //成交笔数
                const td4 = document.createElement('td');
                td4.className = 'count-cell';
                td4.textContent = row['成交笔数'] || '0';
                tr.appendChild(td4);

                tbody.appendChild(tr);
            });
        }

        function showNoData() {
            const tbody = document.getElementById('table-body');
            tbody.innerHTML = `
                <tr>
                    <td colspan="4" class="no-data">
                        <i class="fas fa-inbox"></i>
                        <div>暂无数据</div>
                    </td>
                </tr>
            `;
            document.getElementById('stats-cards').style.display = 'none';
        }

        function mergeCells(table, columnIndex) {
            let lastRowContent = null;
            let rowspanCount = 0;

            for (let i = 1; i < table.rows.length; i++) {
                const currentCell = table.rows[i].cells[columnIndex];
                if (lastRowContent === currentCell.textContent) {
                    rowspanCount++;
                    currentCell.style.display = 'none';
                } else {
                    if (rowspanCount > 0) {
                        table.rows[i - rowspanCount - 1].cells[columnIndex].setAttribute('rowspan', rowspanCount + 1);
                    }
                    lastRowContent = currentCell.textContent;
                    rowspanCount = 0;
                }
            }

            if (rowspanCount > 0) {
                table.rows[table.rows.length - rowspanCount - 1].cells[columnIndex].setAttribute('rowspan', rowspanCount + 1);
            }
        }

        function refreshConnection() {
            if (socket) {
                socket.close();
            }
            if (refreshTimer) {
                clearInterval(refreshTimer);
            }
            firstRenderDone = false;
            reconnectAttempts = 0;
            connectWebSocket();
        }

        // ECharts地图集成
        function getDistrictColor(name) {
            const colorMap = {
                '新城区': '#4ECDC4',
                '碑林区': '#45B7D1',
                '莲湖区': '#96CEB4',
                '灞桥区': '#FFEAA7',
                '未央区': '#DDA0DD',
                '雁塔区': '#98D8C8',
                '阎良区': '#F7DC6F',
                '临潼区': '#BB8FCE',
                '长安区': '#85C1E9',
                '高陵区': '#F8C471',
                '鄠邑区': '#82E0AA',
                '蓝田县': '#F1948A',
                '周至县': '#D7BDE2',
                '高新区': '#A9CCE3',
                '国际港务区': '#F9E79F',
                '经开区': '#D5A6BD',
                '曲江新区': '#A2D9CE',
                '浐灞生态区': '#FAD7A0',
                '其它': '#BFC9CA'
            };
            return colorMap[name] || '#BFC9CA';
        }
        var myChart = echarts.init(document.getElementById('echarts-map'));
        let allStreetData = [];
        let currentView = 'districts';
        let selectedDistrict = null;
        let districtOption = null;
        // 事件绑定防抖
        function bindDistrictClick() {
            myChart.off('click');
            myChart.on('click', function(params) {
                const districtName = params.name;
                if (districtName && currentView === 'districts') {
                    showDistrictStreets(districtName);
                }
            });
        }
        // ECharts内置返回按钮（graphic实现）
        function setBackButton(show) {
            myChart.setOption({
                graphic: show ? [{
                    type: 'group',
                    left: 32,
                    top: 32,
                    z: 100,
                    children: [
                        {
                            type: 'rect',
                            shape: { width: 90, height: 36, r: 18 },
                            style: {
                                fill: '#fff',
                                shadowBlur: 8,
                                shadowColor: 'rgba(2,136,209,0.10)',
                                cursor: 'pointer',
                                stroke: '#eee',
                            }
                        },
                        {
                            type: 'text',
                            left: 36,
                            top: 8,
                            style: {
                                text: '\u25C0 返回',
                                font: 'bold 16px \\"Segoe UI\\", \\"微软雅黑\\", Arial',
                                fill: '#0288d1',
                                cursor: 'pointer',
                            }
                        }
                    ],
                    onclick: function() {
                        returnToDistrictView();
                    }
                }] : []
            });
        }
        fetch('echarts/Data/陕西街道.geojson')
            .then(response => response.json())
            .then(geoJson => {
                const xianDistricts = geoJson.features.filter(feature =>
                    feature.properties && feature.properties.市 === '西安市' && feature.properties.区
                );
                allStreetData = geoJson.features.filter(feature =>
                    feature.properties && feature.properties.市 === '西安市'
                );
                const xianGeoJson = {
                    type: 'FeatureCollection',
                    features: xianDistricts
                };
                xianGeoJson.features.forEach(feature => {
                    if (feature.properties && feature.properties.区) {
                        feature.properties.name = feature.properties.区;
                    }
                });
                echarts.registerMap('xian_district', xianGeoJson);
                const mapData = xianDistricts.map(feature => {
                    const districtName = feature.properties.区 || feature.properties.name || '其它';
                    return {
                        name: districtName,
                        value: 1,
                        itemStyle: {
                            areaColor: getDistrictColor(districtName)
                        }
                    };
                });
                districtOption = {
                    backgroundColor: '#f7f9fa',
                    title: {
                        text: '西安市区地图',
                        left: 'center',
                        top: 32,
                        textStyle: {
                            fontSize: 22,
                            fontWeight: 'bold',
                            color: '#222',
                            fontFamily: '"Segoe UI", "微软雅黑", Arial, sans-serif'
                        }
                    },
                    tooltip: {
                        trigger: 'item',
                        backgroundColor: '#222',
                        borderRadius: 6,
                        textStyle: { color: '#fff', fontSize: 15 },
                        formatter: function(params) {
                            return params.name || '';
                        }
                    },
                    series: [
                        {
                            type: 'map',
                            map: 'xian_district',
                            roam: true,
                            label: { show: false },
                            itemStyle: { borderColor: '#fff', borderWidth: 1 },
                            emphasis: {
                                label: { show: false },
                                itemStyle: { areaColor: '#b3e5fc', borderColor: '#0288d1', borderWidth: 2 }
                            },
                            data: mapData
                        }
                    ]
                };
                myChart.setOption(districtOption);
                setBackButton(false);
                bindDistrictClick();
            });
        function showDistrictStreets(districtName) {
            const streetsInDistrict = allStreetData.filter(feature =>
                feature.properties && feature.properties.区 === districtName
            );
            if (streetsInDistrict.length > 0) {
                selectedDistrict = districtName;
                currentView = 'streets';
                const streetGeoJson = {
                    type: 'FeatureCollection',
                    features: streetsInDistrict
                };
                streetGeoJson.features.forEach(feature => {
                    if (feature.properties && feature.properties.Name) {
                        feature.properties.name = feature.properties.Name;
                    }
                });
                echarts.registerMap('street_detail', streetGeoJson);
                const streetData = streetsInDistrict.map(feature => {
                    return {
                        name: feature.properties.Name || '未知街道',
                        value: 1,
                        itemStyle: {
                            areaColor: '#cccccc',
                            borderColor: '#fff',
                            borderWidth: 1
                        }
                    };
                });
                var streetOption = {
                    backgroundColor: '#f7f9fa',
                    title: {
                        text: `${districtName} - 街道详情`,
                        left: 'center',
                        top: 32,
                        textStyle: {
                            fontSize: 20,
                            fontWeight: 'bold',
                            color: '#222',
                            fontFamily: '"Segoe UI", "微软雅黑", Arial, sans-serif'
                        }
                    },
                    tooltip: {
                        trigger: 'item',
                        backgroundColor: '#222',
                        borderRadius: 6,
                        textStyle: { color: '#fff', fontSize: 14 },
                        formatter: function(params) {
                            return params.name || '';
                        }
                    },
                    series: [
                        {
                            type: 'map',
                            map: 'street_detail',
                            roam: true,
                            label: {
                                show: true,
                                fontSize: 12,
                                color: '#333',
                                fontWeight: 'bold',
                                backgroundColor: 'rgba(255,255,255,0.85)',
                                borderRadius: 4,
                                padding: [2, 6]
                            },
                            itemStyle: { borderColor: '#fff', borderWidth: 1 },
                            emphasis: {
                                label: {
                                    show: true,
                                    fontSize: 13,
                                    color: '#fff',
                                    fontWeight: 'bold',
                                    backgroundColor: '#0288d1',
                                    borderRadius: 5,
                                    padding: [2, 8]
                                },
                                itemStyle: { areaColor: '#b3e5fc', borderColor: '#0288d1', borderWidth: 2 }
                            },
                            data: streetData
                        }
                    ]
                };
                myChart.setOption(streetOption);
                setBackButton(true);
                myChart.off('click'); 
            }
        }
        function returnToDistrictView() {
            currentView = 'districts';
            selectedDistrict = null;
            const mapData = (allStreetData.filter(feature => feature.properties && feature.properties.区)
                .map(feature => {
                    const districtName = feature.properties.区 || feature.properties.name || '其它';
                    return {
                        name: districtName,
                        value: 1,
                        itemStyle: {
                            areaColor: getDistrictColor(districtName)
                        }
                    };
                }));
            const resetOption = {
                backgroundColor: '#f7f9fa',
                title: {
                    text: '西安市区地图',
                    left: 'center',
                    top: 32,
                    textStyle: {
                        fontSize: 22,
                        fontWeight: 'bold',
                        color: '#222',
                        fontFamily: '"Segoe UI", "微软雅黑", Arial, sans-serif'
                    }
                },
                tooltip: {
                    trigger: 'item',
                    backgroundColor: '#222',
                    borderRadius: 6,
                    textStyle: { color: '#fff', fontSize: 15 },
                    formatter: function(params) {
                        return params.name || '';
                    }
                },
                series: [
                    {
                        type: 'map',
                        map: 'xian_district',
                        roam: true,
                        label: { show: false },
                        itemStyle: { borderColor: '#fff', borderWidth: 1 },
                        emphasis: {
                            label: { show: false },
                            itemStyle: { areaColor: '#b3e5fc', borderColor: '#0288d1', borderWidth: 2 }
                        },
                        data: mapData
                    }
                ]
            };
            myChart.setOption(resetOption, true); 
            setBackButton(false);
            bindDistrictClick(); 
        }
    </script>
</body>
</html>


